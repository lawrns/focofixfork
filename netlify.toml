[build]
  # Directory to change to before starting a build
  base = "."

  # Install all dependencies, plugin, then build
  command = "npm ci && npm run build"

[build.environment]
  # Node.js version for builds
  NODE_VERSION = "20"

  # Next.js build configuration
  NEXT_TELEMETRY_DISABLED = "1"

  # Supabase environment variables
  NEXT_PUBLIC_SUPABASE_URL = "https://ouvqnyfqipgnrjnuqsqq.supabase.co"
  NEXT_PUBLIC_SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im91dnFueWZxaXBnbnJqbnVxc3FxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc5MDE0MTgsImV4cCI6MjA4MzQ3NzQxOH0.IWsTnd87r9H0FCxzPGqayhrvqRZN9DZp15U4DM_IXgc"
  SUPABASE_SERVICE_ROLE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im91dnFueWZxaXBnbnJqbnVxc3FxIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc2NzkwMTQxOCwiZXhwIjoyMDgzNDc3NDE4fQ.Gt0n6_y3j6b955ZmiYlKSlFlDJCyyPW7NyPKIink53o"

  # AI environment variables - Using GLM (Z.AI) as primary provider
  AI_PROVIDER = "glm"
  GLM_API_KEY = "bab0035a8192430c9777be04f96fc2c6.YUo6eS7mPkNJh073"
  GLM_MODEL = "glm-4.7"

  # DeepSeek fallback (optional)
  DEEPSEEK_API_KEY = ""
  DEEPSEEK_MODEL = "deepseek-chat"
  DEEPSEEK_BASE_URL = "https://api.deepseek.com"

  # OpenAI environment variables (for transcription only)
  OPENAI_API_KEY = ""
  NEXT_PUBLIC_OPENAI_MODEL = "gpt-4o-mini"
  NEXT_PUBLIC_OPENAI_CHAT_MODEL = "gpt-4o-mini"

  # Demo mode configuration - DISABLED for production
  NEXT_PUBLIC_DEMO_MODE = "false"
  NEXT_PUBLIC_ALLOW_UNRESTRICTED_ACCESS = "false"
  NEXT_PUBLIC_BYPASS_ROLE_CHECKS = "false"
  NEXT_PUBLIC_DEMO_SEED_DATA = "false"

# Next.js plugin
[[plugins]]
  package = "@netlify/plugin-nextjs"

# Headers for service worker
[[headers]]
  for = "/sw.js"
  [headers.values]
    Cache-Control = "no-store, must-revalidate"

# Cache busting for API routes
[[headers]]
  for = "/api/*"
  [headers.values]
    Cache-Control = "no-cache, no-store, must-revalidate"

# Build processing and headers are handled automatically by @netlify/plugin-nextjs
# HTTPS redirects are handled automatically by Netlify
